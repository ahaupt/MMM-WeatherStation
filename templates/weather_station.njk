{# Set shortcut variables #}
{% set config = module.config %}
{% set weatherData = module.sensorData %}

{% macro temp_data(where) %}
<tr>
  <td>
    <i class="margin fas fa-{{ 'home' if where == 'indoor' else 'sun' }}"></i>
    <i class="margin fas fa-thermometer-half smallrow"></i>
  </td>
  {% set cur_temp = weatherData[where+'-celcius'] %}
  {% set cur_temp_color = module.tempHue(cur_temp) %}
  <td colspan="3" style="color:hsl({{cur_temp_color}},75%,60%)">
    <i class="margin">{{ cur_temp }}째C</i>
  </td>

  <td><i class="margin fa fa-tint smallrow"></i></td>
  {% set cur_humi = weatherData[where+'-humidity'] %}
  {% set cur_humi_color = module.humiHue(cur_humi) %}
  <td colspan="3" style="color:hsl({{cur_humi_color}},75%,60%)">
    <i class="margin">{{ cur_humi | round }}%</i>
  </td>
</tr>
<tr>
  <td><i class="margin smallrow minimum fa fa-thermometer-empty"></i></td>
  {% set min_temp = weatherData[where+'-celcius-min'] %}
  {% set min_temp_color = module.tempHue(min_temp) %}
  <td style="color:hsl({{min_temp_color}},75%,60%)"><i class="margin smallrow">{{ min_temp }}째C</i></td>
  <td><i class="margin smallrow maximum fa fa-thermometer-full"></i></td>
  {% set max_temp = weatherData[where+'-celcius-max'] %}
  {% set max_temp_color = module.tempHue(max_temp) %}
  <td style="color:hsl({{max_temp_color}},75%,60%)"><i class="margin smallrow">{{ max_temp }}째C</i></td>

  <td/>
  <td><i class="margin smallrow">{{ weatherData[where+'-dewpoint-celcius'] }}째C</i></td>
</tr>
{% endmacro %}

{% macro airpressure() %}
<tr>
  <td></td>
  {% set airpressure = weatherData['air-pressure'] %}
  {% set airpressure_trend = airpressure - weatherData['air-pressure-1hour'] %}
  {% set airpressure_color = module.airpressureHue(airpressure) %}
  {% set airpressure_trend_color = module.airpressureTrendHue(airpressure_trend) %}
  <td colspan="3" style="color:hsl({{airpressure_color}},75%,60%)">
    <i class="margin medium">{{weatherData['air-pressure']}} hPa</i>
  </td>
  <td><i class="margin medium fas {{ module.airPressureDeltaSymbol(airpressure_trend) }}"></i></td>
  <td style="color:hsl({{airpressure_trend_color}},75%,60%)">
    <i class="margin medium">{{airpressure_trend | round(1)}}</i>
  </td>
</tr>
{% endmacro %}

<div class="large">
  <table><tbody>
    {% for place in ['indoor', 'outdoor'] %}
    {{ temp_data(place) }}
    {% endfor %}
    {{ airpressure() }}
  </tbody></table>
</div>

